## Option 1: Run the script remotely via SSH

If the script is already on the remote host:

bash

```
ssh user@remote-host 'bash -s' < ./pcap_beacons.sh /path/to/capture.pcap
```

Or if the script is executable on the remote:

bash

```
ssh user@remote-host '~/tools/pcap_beacons.sh /tmp/capture.pcap'
```

For the Python detector:

bash

```
ssh user@remote-host 'python3 ~/tools/beacon_detect.py --input /tmp/hits.txt --registry ~/registry.csv'
```

##  Option 2: Copy script over, then run

bash

```
scp pcap_beacons.sh user@remote-host:/tmp/
ssh user@remote-host 'chmod +x /tmp/pcap_beacons.sh && /tmp/pcap_beacons.sh /tmp/capture.pcap'
```

##  Option 3: Copy data back, run locally (often easier)

bash

```
scp user@remote-host:/tmp/capture.pcap .
./pcap_beacons.sh capture.pcap | python3 beacon_detect.py --registry registry.csv
```

## Suggested Workflow

- **Field device** (remote): run `tcpdump` or `tshark` to capture traffic into a `.pcap`.
    
- **Pull back** the `.pcap` to your Kali analysis box.
    
- **Run locally** with your tested scripts (`pcap_beacons.sh` → `beacon_detect.py`).
    

This keeps your detection logic consistent and avoids dependency mismatches on the remote.

##  Quick Example End‑to‑End

1. Capture on remote:
    
    bash
    
    ```
    ssh user@remote 'sudo tcpdump -i eth0 -w /tmp/capture.pcap'
    ```
    
2. Copy back:
    
    bash
    
    ```
    scp user@remote:/tmp/capture.pcap .
    ```
    
3. Analyze locally:
    
    bash
    
    ```
    ./pcap_beacons.sh capture.pcap | python3 beacon_detect.py --registry registry.csv
    ```